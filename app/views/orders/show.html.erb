<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Pedido #<%= @order.id %></h1>
    
    <% status_class = case @order.status
      when 'pending' then 'warning'
      when 'paid' then 'success'
      when 'cancelled' then 'danger'
      else 'secondary'
      end %>
    <span class="badge bg-<%= status_class %> fs-6">
      <%= @order.status_formatado %>
    </span>
  </div>

  <div class="card mb-4">
    <div class="card-header">
      <div class="row">
        <div class="col-md-6">
          <strong>Data do Pedido:</strong>
          <br>
          <%= @order.created_at.strftime("%d/%m/%Y %H:%M") %>
        </div>
      </div>
    </div>

    <div class="card-body">
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th>Produto</th>
              <th class="text-center">Quantidade</th>
              <th class="text-end">Preço Unitário</th>
              <th class="text-end">Subtotal</th>
            </tr>
          </thead>
          <tbody>
            <% @order.order_items.each do |item| %>
              <tr>
                <td>
                  <div class="d-flex align-items-center">
                    <img src="<%= item.produto.foto %>" alt="<%= item.produto.name %>" class="me-3" style="width: 50px; height: 50px; object-fit: cover;">
                    <%= item.produto.name %>
                  </div>
                </td>
                <td class="text-center"><%= item.quantidade %></td>
                <td class="text-end">
                  <%= number_to_currency(item.preco_unitario, unit: "R$", separator: ",", delimiter: ".") %>
                </td>
                <td class="text-end">
                  <%= number_to_currency(item.subtotal, unit: "R$", separator: ",", delimiter: ".") %>
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" class="text-end"><strong>Total:</strong></td>
              <td class="text-end">
                <strong><%= number_to_currency(@order.total, unit: "R$", separator: ",", delimiter: ".") %></strong>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>

  <div class="text-end">
    <%= link_to orders_path, class: "btn btn-outline-primary" do %>
      <i class="bi bi-arrow-left"></i> Voltar para Meus Pedidos
    <% end %>
<<<<<<< Updated upstream
  </tbody>
  <tfoot>
    <tr>
      <td colspan="3"><strong>Total:</strong></td>
      <td><strong>R$ <%= @order.total %></strong></td>
    </tr>
  </tfoot>
</table>

<% if @order.can_pay? %>
  <div style="margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
    <h2>Pagamento</h2>
    <p>
      Para finalizar seu pedido, clique no botão abaixo para ser redirecionado ao Mercado Pago:
    </p>
    
    <%= link_to "Pagar com Mercado Pago", @order.payment_url, 
                class: "button", 
                style: "display: inline-block; padding: 10px 20px; background-color: #009ee3; color: white; text-decoration: none; border-radius: 5px;" %>
    
    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
      Após o pagamento, você será redirecionado de volta para nossa loja e receberá um e-mail de confirmação.
    </p>
  </div>
<% elsif @order.paid? %>
  <div style="margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; background-color: #e8f5e9;">
    <h2 style="color: #2e7d32;">Pagamento Confirmado</h2>
    <p>
      Seu pagamento foi processado com sucesso! Em breve você receberá mais informações por e-mail.
    </p>
  </div>
<% end %>

<div style="margin-top: 20px;">
  <%= link_to "Voltar para Meus Pedidos", orders_path, 
              style: "text-decoration: none; color: #666;" %>
=======
  </div>
>>>>>>> Stashed changes
</div>